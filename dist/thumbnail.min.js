!function(e,r){"object"==typeof exports&&"undefined"!=typeof module?module.exports=r(require("core-js/modules/es.symbol"),require("core-js/modules/es.symbol.description"),require("core-js/modules/es.symbol.iterator"),require("core-js/modules/es.array.for-each"),require("core-js/modules/es.array.index-of"),require("core-js/modules/es.array.iterator"),require("core-js/modules/es.array.last-index-of"),require("core-js/modules/es.number.constructor"),require("core-js/modules/es.object.keys"),require("core-js/modules/es.object.to-string"),require("core-js/modules/es.regexp.exec"),require("core-js/modules/es.string.iterator"),require("core-js/modules/es.string.search"),require("core-js/modules/web.dom-collections.for-each"),require("core-js/modules/web.dom-collections.iterator"),require("core-js/modules/es.promise"),require("url")):"function"==typeof define&&define.amd?define(["core-js/modules/es.symbol","core-js/modules/es.symbol.description","core-js/modules/es.symbol.iterator","core-js/modules/es.array.for-each","core-js/modules/es.array.index-of","core-js/modules/es.array.iterator","core-js/modules/es.array.last-index-of","core-js/modules/es.number.constructor","core-js/modules/es.object.keys","core-js/modules/es.object.to-string","core-js/modules/es.regexp.exec","core-js/modules/es.string.iterator","core-js/modules/es.string.search","core-js/modules/web.dom-collections.for-each","core-js/modules/web.dom-collections.iterator","core-js/modules/es.promise","url"],r):(e=e||self).Thumbnail=r(null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,e.url)}(this,function(e,r,t,o,s,n,i,a,l,u,c,d,f,m,b,y,v){"use strict";function h(e,r){return function(e){if(Array.isArray(e))return e}(e)||function(e,r){var t=[],o=!0,s=!1,n=void 0;try{for(var i,a=e[Symbol.iterator]();!(o=(i=a.next()).done)&&(t.push(i.value),!r||t.length!==r);o=!0);}catch(e){s=!0,n=e}finally{try{o||null==a.return||a.return()}finally{if(s)throw n}}return t}(e,r)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function p(o){return new Promise(function(e,r){var t=new Image;t.onload=function(){e()},t.src=o})}v=v&&v.hasOwnProperty("default")?v.default:v;var j=function(){if("undefined"==typeof window)return!1;var r=!0,e=document;try{var t=e.createElement("object");t.type="image/webp",t.style.visibility="hidden",t.innerHTML="!",e.body.appendChild(t),r=!t.offsetWidth,e.body.removeChild(t)}catch(e){r=!1}return r}();function w(e){return null==e}var g=!1,q=null;function x(e,r,t){t?"poster"===t?e.setAttribute("poster",r):e.style[t]="url(".concat(r,")"):e.setAttribute("src",r)}function O(u){return function(r,e){if(q&&(!u||e.value!==e.oldValue)){var t=r.dataset,o=e.value,s=e.arg,n=t.thumbnailWidth,i=q.doTransform||k;if(!n||isNaN(Number(n))){var a=i([o],t,q.imageFilter);x(r,a[0],s)}else{r.classList.add(q.enterClass||"");var l=i([o],function(s){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(e){var r,t,o;r=s,o=n[t=e],t in r?Object.defineProperty(r,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):r[t]=o})}return s}({},t,{width:n}),q.imageFilter)[0];x(r,l,s),p(l).then(function(){var e=h(i([o],t,q.imageFilter),1)[0];p(e).then(function(){x(r,e,s),r.classList.add(q.leaveClass||""),r.ontransitionend=function(){r.classList.remove(q.enterClass||""),r.classList.remove(q.leaveClass||"")}})})}}}}function k(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},o=2<arguments.length?arguments[2]:void 0,s=[],n=Object.keys(o),r=!0,i=!1,a=void 0;try{for(var l,u=function(){var e=l.value,r={el:{dataset:t},src:e};n.forEach(function(e){(0,o[e])(r,{supportWebp:j})}),s.push(r.src)},c=e[Symbol.iterator]();!(r=(l=c.next()).done);r=!0)u()}catch(e){i=!0,a=e}finally{try{r||null==c.return||c.return()}finally{if(i)throw a}}return s}return{install:function(e,r){!g&&r&&(g=!0,q=r,e.directive("thumbnail",{bind:O(!1),update:O(!0)}))},doTransform:k,generateImageFilter:function(l){return{addData:function(e,r){e.ro||(e.ro={});var t=e.el.dataset;"true"!==t.avatar&&!t.avatar||(e.ro.avatar=!0)},domain:function(e,r){var t=e.src;if(t&&l.bed&&0!==t.indexOf("https://")&&0!==t.indexOf("http://")&&0!==t.indexOf("//")&&"/"===t[0]){var o=e.el.dataset.bed,s=l.bed[o]||l.bed.default;s&&(e.src=s+t)}},webp:function(e,r){if(r.supportWebp){var t=e.el.dataset;!1!==t.webp&&"false"!==t.webp&&(e.ro.webp=!0)}},interlace:function(e,r){var t=e.el.dataset;w(t.interlace)||(e.ro.interlace=t.interlace)},size:function(e,r){var t=e.el.dataset;w(t.width)||(e.ro.width=t.width)},qiniu:function(e,r){if(l.isQiniu&&l.isQiniu(e,r)){var t=e.ro;if(0===Object.keys(t).length)return;var o="?imageView2/2",s=!1;t.width&&(o+="/w/".concat(t.width),s=!0),t.webp&&(o+="/format/webp",s=!0),s&&(e.src+=o)}},aliyun:function(e,r){if(l.isAliyun&&l.isAliyun(e,r)){var t=e.ro;if(0===Object.keys(t).length)return;var o="image",s=!1;if(t.width&&(o+="/resize,w_".concat(t.width),s=!0),t.webp&&(o+="/format,webp",s=!0),t.interlace&&(o+="/interlace,1",s=!0),s){var n=v.parse(e.src,!0);delete n.search,n.query?n.query["x-oss-process"]=o:n.query={"x-oss-process":o},e.src=v.format(n)}}},wx:function(e,r){if(l.isWeChat&&l.isWeChat(e,r)){var t=e.ro;if(0===Object.keys(t).length)return;var o=[46,64,96,132,640];if(t.width){for(var s=640,n=0,i=o.length;n<i;n++)if(o[n]>t.width){s=o[n];break}640===s&&(s=0);var a=e.src.lastIndexOf("/");e.src=e.src.substr(0,a)+"/"+s}}},none:function(e,r){if(w(e.src)||""===e.src){var t=e.ro;if(0===Object.keys(t).length)return;t.avatar&&l.defaultImageUrl&&(e.src=l.defaultImageUrl)}}}}}});
