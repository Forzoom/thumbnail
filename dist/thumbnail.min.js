!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t(require("core-js/modules/es6.array.last-index-of"),require("core-js/modules/es6.regexp.search"),require("core-js/modules/es6.array.index-of"),require("core-js/modules/es6.array.for-each"),require("core-js/modules/es7.symbol.async-iterator"),require("core-js/modules/es6.symbol"),require("core-js/modules/web.dom.iterable"),require("core-js/modules/es6.array.iterator"),require("core-js/modules/es6.object.to-string"),require("core-js/modules/es6.object.keys"),require("core-js/modules/es6.number.constructor"),require("core-js/modules/es6.promise")):"function"==typeof define&&define.amd?define(["core-js/modules/es6.array.last-index-of","core-js/modules/es6.regexp.search","core-js/modules/es6.array.index-of","core-js/modules/es6.array.for-each","core-js/modules/es7.symbol.async-iterator","core-js/modules/es6.symbol","core-js/modules/web.dom.iterable","core-js/modules/es6.array.iterator","core-js/modules/es6.object.to-string","core-js/modules/es6.object.keys","core-js/modules/es6.number.constructor","core-js/modules/es6.promise"],t):(e=e||self).Thumbnail=t()}(this,function(){"use strict";function u(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=[],n=!0,o=!1,a=void 0;try{for(var s,i=e[Symbol.iterator]();!(n=(s=i.next()).done)&&(r.push(s.value),!t||r.length!==t);n=!0);}catch(e){o=!0,a=e}finally{try{n||null==i.return||i.return()}finally{if(o)throw a}}return r}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function l(n){return new Promise(function(e,t){var r=new Image;r.onload=function(){e()},r.src=n})}var c=function(){if("undefined"==typeof window)return!1;var t=!0,e=document;try{var r=e.createElement("object");r.type="image/webp",r.style.visibility="hidden",r.innerHTML="!",e.body.appendChild(r),t=!r.offsetWidth,e.body.removeChild(r)}catch(e){t=!1}return t}();function n(e){return null==e}var y=2147483647,b=36,g=1,j=26,o=38,a=700,w=72,O=128,x="-",t=/[^\x20-\x7E]/,s=/[\x2E\u3002\uFF0E\uFF61]/g,r={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},i=b-g,q=Math.floor,C=String.fromCharCode;function A(e){throw new RangeError(r[e])}function I(e,t){return e+22+75*(e<26)-((0!=t)<<5)}function k(e,t,r){var n=0;for(e=r?q(e/a):e>>1,e+=q(e/t);i*j>>1<e;n+=b)e=q(e/i);return q(n+(i+1)*e/(e+o))}function T(e){return function(e,t){var r=e.split("@"),n="";return 1<r.length&&(n=r[0]+"@",e=r[1]),n+function(e,t){for(var r=e.length,n=[];r--;)n[r]=t(e[r]);return n}((e=e.replace(s,".")).split("."),t).join(".")}(e,function(e){return t.test(e)?"xn--"+function(e){var t,r,n,o,a,s,i,h,u,l,c,f,p,m,d,v=[];for(f=(e=function(e){for(var t,r,n=[],o=0,a=e.length;o<a;)55296<=(t=e.charCodeAt(o++))&&t<=56319&&o<a?56320==(64512&(r=e.charCodeAt(o++)))?n.push(((1023&t)<<10)+(1023&r)+65536):(n.push(t),o--):n.push(t);return n}(e)).length,t=O,a=w,s=r=0;s<f;++s)(c=e[s])<128&&v.push(C(c));for(n=o=v.length,o&&v.push(x);n<f;){for(i=y,s=0;s<f;++s)t<=(c=e[s])&&c<i&&(i=c);for(i-t>q((y-r)/(p=n+1))&&A("overflow"),r+=(i-t)*p,t=i,s=0;s<f;++s)if((c=e[s])<t&&++r>y&&A("overflow"),c==t){for(h=r,u=b;!(h<(l=u<=a?g:a+j<=u?j:u-a));u+=b)d=h-l,m=b-l,v.push(C(I(l+d%m,0))),h=q(d/m);v.push(C(I(h,0))),a=k(r,p,n==o),r=0,++n}++r,++t}return v.join("")}(e):e})}global.setTimeout,global.clearTimeout;var e=global.performance||{};e.now||e.mozNow||e.msNow||e.oNow||e.webkitNow;function U(e){return null===e}function L(e){return"string"==typeof e}function h(e){return"object"==typeof e&&null!==e}var R=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)};function f(e){switch(typeof e){case"string":return e;case"boolean":return e?"true":"false";case"number":return isFinite(e)?e:"";default:return""}}function p(e,t){if(e.map)return e.map(t);for(var r=[],n=0;n<e.length;n++)r.push(t(e[n],n));return r}var m=Object.keys||function(e){var t=[];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.push(r);return t};function N(e,t,r,n){t=t||"&",r=r||"=";var o={};if("string"!=typeof e||0===e.length)return o;var a=/\+/g;e=e.split(t);var s=1e3;n&&"number"==typeof n.maxKeys&&(s=n.maxKeys);var i,h,u=e.length;0<s&&s<u&&(u=s);for(var l=0;l<u;++l){var c,f,p,m,d=e[l].replace(a,"%20"),v=d.indexOf(r);f=0<=v?(c=d.substr(0,v),d.substr(v+1)):(c=d,""),p=decodeURIComponent(c),m=decodeURIComponent(f),i=o,h=p,Object.prototype.hasOwnProperty.call(i,h)?R(o[p])?o[p].push(m):o[p]=[o[p],m]:o[p]=m}return o}var d={parse:P,resolve:function(e,t){return P(e,!1,!0).resolve(t)},resolveObject:function(e,t){return e?P(e,!1,!0).resolveObject(t):t},format:function(e){L(e)&&(e=Z({},e));return B(e)},Url:E};function E(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}var z=/^([a-z0-9.+-]+:)/i,v=/:[0-9]*$/,S=/^(\/\/?(?!\/)[^\?\s]*)(\?[^\s]*)?$/,F=["{","}","|","\\","^","`"].concat(["<",">",'"',"`"," ","\r","\n","\t"]),W=["'"].concat(F),$=["%","/","?",";","#"].concat(W),_=["/","?","#"],D=255,H=/^[+a-z0-9A-Z_-]{0,63}$/,K=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,M={javascript:!0,"javascript:":!0},Q={javascript:!0,"javascript:":!0},V={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0};function P(e,t,r){if(e&&h(e)&&e instanceof E)return e;var n=new E;return n.parse(e,t,r),n}function Z(e,t,r,n){if(!L(t))throw new TypeError("Parameter 'url' must be a string, not "+typeof t);var o=t.indexOf("?"),a=-1!==o&&o<t.indexOf("#")?"?":"#",s=t.split(a);s[0]=s[0].replace(/\\/g,"/");var i=t=s.join(a);if(i=i.trim(),!n&&1===t.split("#").length){var h=S.exec(i);if(h)return e.path=i,e.href=i,e.pathname=h[1],h[2]?(e.search=h[2],e.query=r?N(e.search.substr(1)):e.search.substr(1)):r&&(e.search="",e.query={}),e}var u,l,c,f,p=z.exec(i);if(p){var m=(p=p[0]).toLowerCase();e.protocol=m,i=i.substr(p.length)}if(n||p||i.match(/^\/\/[^@\/]+@[^@\/]+/)){var d="//"===i.substr(0,2);!d||p&&Q[p]||(i=i.substr(2),e.slashes=!0)}if(!Q[p]&&(d||p&&!V[p])){var v,y,b=-1;for(u=0;u<_.length;u++)-1!==(l=i.indexOf(_[u]))&&(-1===b||l<b)&&(b=l);for(-1!==(y=-1===b?i.lastIndexOf("@"):i.lastIndexOf("@",b))&&(v=i.slice(0,y),i=i.slice(y+1),e.auth=decodeURIComponent(v)),b=-1,u=0;u<$.length;u++)-1!==(l=i.indexOf($[u]))&&(-1===b||l<b)&&(b=l);-1===b&&(b=i.length),e.host=i.slice(0,b),i=i.slice(b),G(e),e.hostname=e.hostname||"";var g="["===e.hostname[0]&&"]"===e.hostname[e.hostname.length-1];if(!g){var j=e.hostname.split(/\./);for(u=0,c=j.length;u<c;u++){var w=j[u];if(w&&!w.match(H)){for(var O="",x=0,q=w.length;x<q;x++)127<w.charCodeAt(x)?O+="x":O+=w[x];if(!O.match(H)){var C=j.slice(0,u),A=j.slice(u+1),I=w.match(K);I&&(C.push(I[1]),A.unshift(I[2])),A.length&&(i="/"+A.join(".")+i),e.hostname=C.join(".");break}}}}e.hostname.length>D?e.hostname="":e.hostname=e.hostname.toLowerCase(),g||(e.hostname=T(e.hostname)),f=e.port?":"+e.port:"";var k=e.hostname||"";e.host=k+f,e.href+=e.host,g&&(e.hostname=e.hostname.substr(1,e.hostname.length-2),"/"!==i[0]&&(i="/"+i))}if(!M[m])for(u=0,c=W.length;u<c;u++){var U=W[u];if(-1!==i.indexOf(U)){var R=encodeURIComponent(U);R===U&&(R=escape(U)),i=i.split(U).join(R)}}var E=i.indexOf("#");-1!==E&&(e.hash=i.substr(E),i=i.slice(0,E));var F=i.indexOf("?");if(-1!==F?(e.search=i.substr(F),e.query=i.substr(F+1),r&&(e.query=N(e.query)),i=i.slice(0,F)):r&&(e.search="",e.query={}),i&&(e.pathname=i),V[m]&&e.hostname&&!e.pathname&&(e.pathname="/"),e.pathname||e.search){f=e.pathname||"";var P=e.search||"";e.path=f+P}return e.href=B(e),e}function B(e){var t=e.auth||"";t&&(t=(t=encodeURIComponent(t)).replace(/%3A/i,":"),t+="@");var r=e.protocol||"",n=e.pathname||"",o=e.hash||"",a=!1,s="";e.host?a=t+e.host:e.hostname&&(a=t+(-1===e.hostname.indexOf(":")?e.hostname:"["+this.hostname+"]"),e.port&&(a+=":"+e.port)),e.query&&h(e.query)&&Object.keys(e.query).length&&(s=function(r,n,o,e){return n=n||"&",o=o||"=",null===r&&(r=void 0),"object"==typeof r?p(m(r),function(e){var t=encodeURIComponent(f(e))+o;return R(r[e])?p(r[e],function(e){return t+encodeURIComponent(f(e))}).join(n):t+encodeURIComponent(f(r[e]))}).join(n):e?encodeURIComponent(f(e))+o+encodeURIComponent(f(r)):""}(e.query));var i=e.search||s&&"?"+s||"";return r&&":"!==r.substr(-1)&&(r+=":"),e.slashes||(!r||V[r])&&!1!==a?(a="//"+(a||""),n&&"/"!==n.charAt(0)&&(n="/"+n)):a=a||"",o&&"#"!==o.charAt(0)&&(o="#"+o),i&&"?"!==i.charAt(0)&&(i="?"+i),r+a+(n=n.replace(/[?#]/g,function(e){return encodeURIComponent(e)}))+(i=i.replace("#","%23"))+o}function G(e){var t=e.host,r=v.exec(t);r&&(":"!==(r=r[0])&&(e.port=r.substr(1)),t=t.substr(0,t.length-r.length)),t&&(e.hostname=t)}E.prototype.parse=function(e,t,r){return Z(this,e,t,r)},E.prototype.format=function(){return B(this)},E.prototype.resolve=function(e){return this.resolveObject(P(e,!1,!0)).format()},E.prototype.resolveObject=function(e){if(L(e)){var t=new E;t.parse(e,!1,!0),e=t}for(var r,n=new E,o=Object.keys(this),a=0;a<o.length;a++){var s=o[a];n[s]=this[s]}if(n.hash=e.hash,""===e.href)return n.href=n.format(),n;if(e.slashes&&!e.protocol){for(var i=Object.keys(e),h=0;h<i.length;h++){var u=i[h];"protocol"!==u&&(n[u]=e[u])}return V[n.protocol]&&n.hostname&&!n.pathname&&(n.path=n.pathname="/"),n.href=n.format(),n}if(e.protocol&&e.protocol!==n.protocol){if(!V[e.protocol]){for(var l=Object.keys(e),c=0;c<l.length;c++){var f=l[c];n[f]=e[f]}return n.href=n.format(),n}if(n.protocol=e.protocol,e.host||Q[e.protocol])n.pathname=e.pathname;else{for(r=(e.pathname||"").split("/");r.length&&!(e.host=r.shift()););e.host||(e.host=""),e.hostname||(e.hostname=""),""!==r[0]&&r.unshift(""),r.length<2&&r.unshift(""),n.pathname=r.join("/")}if(n.search=e.search,n.query=e.query,n.host=e.host||"",n.auth=e.auth,n.hostname=e.hostname||e.host,n.port=e.port,n.pathname||n.search){var p=n.pathname||"",m=n.search||"";n.path=p+m}return n.slashes=n.slashes||e.slashes,n.href=n.format(),n}var d,v=n.pathname&&"/"===n.pathname.charAt(0),y=e.host||e.pathname&&"/"===e.pathname.charAt(0),b=y||v||n.host&&e.pathname,g=b,j=n.pathname&&n.pathname.split("/")||[],w=n.protocol&&!V[n.protocol];if(r=e.pathname&&e.pathname.split("/")||[],w&&(n.hostname="",n.port=null,n.host&&(""===j[0]?j[0]=n.host:j.unshift(n.host)),n.host="",e.protocol&&(e.hostname=null,e.port=null,e.host&&(""===r[0]?r[0]=e.host:r.unshift(e.host)),e.host=null),b=b&&(""===r[0]||""===j[0])),y)n.host=e.host||""===e.host?e.host:n.host,n.hostname=e.hostname||""===e.hostname?e.hostname:n.hostname,n.search=e.search,n.query=e.query,j=r;else if(r.length)(j=j||[]).pop(),j=j.concat(r),n.search=e.search,n.query=e.query;else if(!function(e){return null==e}(e.search))return w&&(n.hostname=n.host=j.shift(),(d=!!(n.host&&0<n.host.indexOf("@"))&&n.host.split("@"))&&(n.auth=d.shift(),n.host=n.hostname=d.shift())),n.search=e.search,n.query=e.query,U(n.pathname)&&U(n.search)||(n.path=(n.pathname?n.pathname:"")+(n.search?n.search:"")),n.href=n.format(),n;if(!j.length)return n.pathname=null,n.search?n.path="/"+n.search:n.path=null,n.href=n.format(),n;for(var O=j.slice(-1)[0],x=(n.host||e.host||1<j.length)&&("."===O||".."===O)||""===O,q=0,C=j.length;0<=C;C--)"."===(O=j[C])?j.splice(C,1):".."===O?(j.splice(C,1),q++):q&&(j.splice(C,1),q--);if(!b&&!g)for(;q--;)j.unshift("..");!b||""===j[0]||j[0]&&"/"===j[0].charAt(0)||j.unshift(""),x&&"/"!==j.join("/").substr(-1)&&j.push("");var A=""===j[0]||j[0]&&"/"===j[0].charAt(0);return w&&(n.hostname=n.host=A?"":j.length?j.shift():"",(d=!!(n.host&&0<n.host.indexOf("@"))&&n.host.split("@"))&&(n.auth=d.shift(),n.host=n.hostname=d.shift())),(b=b||n.host&&j.length)&&!A&&j.unshift(""),j.length?n.pathname=j.join("/"):(n.pathname=null,n.path=null),U(n.pathname)&&U(n.search)||(n.path=(n.pathname?n.pathname:"")+(n.search?n.search:"")),n.auth=e.auth||n.auth,n.slashes=n.slashes||e.slashes,n.href=n.format(),n};var J=!(E.prototype.parseHost=function(){return G(this)}),X=null;function Y(e,t,r){r?e.style[r]="url(".concat(t,")"):e.setAttribute("src",t)}function ee(t,e){if(X&&e.value!==e.oldValue){var r=t.dataset,n=e.value,o=e.arg,a=r.thumbnailWidth,s=X.doTransform||te;if(!a||isNaN(Number(a))){var i=u(s([n],r,X.imageFilter),1)[0];Y(t,i,o)}else{t.classList.add(X.enterClass||"");var h=u(s([n],function(o){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{},t=Object.keys(a);"function"==typeof Object.getOwnPropertySymbols&&(t=t.concat(Object.getOwnPropertySymbols(a).filter(function(e){return Object.getOwnPropertyDescriptor(a,e).enumerable}))),t.forEach(function(e){var t,r,n;t=o,n=a[r=e],r in t?Object.defineProperty(t,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[r]=n})}return o}({},r,{width:a}),X.imageFilter),1)[0];Y(t,h,o),l(h).then(function(){var e=u(s([n],r,X.imageFilter),1)[0];l(e).then(function(){Y(t,e,o),t.classList.add(X.leaveClass||""),t.ontransitionend=function(){t.classList.remove(X.enterClass||""),t.classList.remove(X.leaveClass||"")}})})}}}function te(e){var r=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},n=2<arguments.length?arguments[2]:void 0,o=[],a=Object.keys(n),t=!0,s=!1,i=void 0;try{for(var h,u=function(){var e=h.value,t={el:{dataset:r},src:e};a.forEach(function(e){(0,n[e])(t,{supportWebp:c})}),o.push(t.src)},l=e[Symbol.iterator]();!(t=(h=l.next()).done);t=!0)u()}catch(e){s=!0,i=e}finally{try{t||null==l.return||l.return()}finally{if(s)throw i}}return o}return{install:function(e,t){!J&&t&&(J=!0,X=t,e.directive("thumbnail",{bind:ee,update:ee}))},doTransform:te,generateImageFilter:function(h){return{addData:function(e,t){e.ro||(e.ro={});var r=e.el.dataset;"true"!==r.avatar&&!r.avatar||(e.ro.avatar=!0)},domain:function(e,t){var r=e.src;if(r&&h.bed&&0!==r.indexOf("https://")&&0!==r.indexOf("http://")&&0!==r.indexOf("//")&&"/"===r[0]){var n=e.el.dataset.bed,o=h.bed[n]||h.bed.default;o&&(e.src=o+r)}},webp:function(e,t){if(t.supportWebp){var r=e.el.dataset;!1!==r.webp&&"false"!==r.webp&&(e.ro.webp=!0)}},interlace:function(e,t){var r=e.el.dataset;n(r.interlace)||(e.ro.interlace=r.interlace)},size:function(e,t){var r=e.el.dataset;n(r.width)||(e.ro.width=r.width)},qiniu:function(e,t){if(h.isQiniu&&h.isQiniu(e,t)){var r=e.ro;if(0===Object.keys(r).length)return;var n="?imageView2/2",o=!1;r.width&&(n+="/w/".concat(r.width),o=!0),r.webp&&(n+="/format/webp",o=!0),o&&(e.src+=n)}},aliyun:function(e,t){if(h.isAliyun&&h.isAliyun(e,t)){var r=e.ro;if(0===Object.keys(r).length)return;var n="image",o=!1;if(r.width&&(n+="/resize,w_".concat(r.width),o=!0),r.webp&&(n+="/format,webp",o=!0),r.interlace&&(n+="/interlace,1",o=!0),o){var a=d.parse(e.src,!0);delete a.search,a.query?a.query["x-oss-process"]=n:a.query={"x-oss-process":n},e.src=d.format(a)}}},wx:function(e,t){if(h.isWeChat&&h.isWeChat(e,t)){var r=e.ro;if(0===Object.keys(r).length)return;var n=[46,64,96,132,640];if(r.width){for(var o=640,a=0,s=n.length;a<s;a++)if(n[a]>r.width){o=n[a];break}640===o&&(o=0);var i=e.src.lastIndexOf("/");e.src=e.src.substr(0,i)+"/"+o}}},none:function(e,t){if(n(e.src)||""===e.src){var r=e.ro;if(0===Object.keys(r).length)return;r.avatar&&h.defaultImageUrl&&(e.src=h.defaultImageUrl)}}}}}});
